<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>TripleGit: triplegit/include/async_file_io.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TripleGit
   &#160;<span id="projectnumber">v0.01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5702f8a2329a6e3cef9103a99d8690ff.html">triplegit</a></li><li class="navelem"><a class="el" href="dir_603090840fc3140f581dcce46ee211a4.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">async_file_io.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides a batch asynchronous file i/o implementation based on Boost.ASIO.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;../../NiallsCPP11Utilities/NiallsCPP11Utilities.hpp&quot;</code><br/>
<code>#include &quot;../../NiallsCPP11Utilities/std_filesystem.hpp&quot;</code><br/>
<code>#include &lt;initializer_list&gt;</code><br/>
<code>#include &lt;thread&gt;</code><br/>
<code>#include &lt;atomic&gt;</code><br/>
<code>#include &lt;exception&gt;</code><br/>
<code>#include &quot;boost/asio.hpp&quot;</code><br/>
<code>#include &quot;boost/thread/thread.hpp&quot;</code><br/>
<code>#include &quot;boost/thread/future.hpp&quot;</code><br/>
</div>
<p><a href="async__file__io_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriplegit_1_1async__io_1_1future.html">triplegit::async_io::future&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">For now, this is boost's future. Will be replaced when C++'s future catches up with boost's.  <a href="classtriplegit_1_1async__io_1_1future.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriplegit_1_1async__io_1_1shared__future.html">triplegit::async_io::shared_future&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">For now, this is boost's <a class="el" href="classtriplegit_1_1async__io_1_1shared__future.html" title="For now, this is boost&#39;s shared_future. Will be replaced when C++&#39;s shared_future catches up with boo...">shared_future</a>. Will be replaced when C++'s <a class="el" href="classtriplegit_1_1async__io_1_1shared__future.html" title="For now, this is boost&#39;s shared_future. Will be replaced when C++&#39;s shared_future catches up with boo...">shared_future</a> catches up with boost's.  <a href="classtriplegit_1_1async__io_1_1shared__future.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriplegit_1_1async__io_1_1promise.html">triplegit::async_io::promise&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">For now, this is boost's promise. Will be replaced when C++'s promise catches up with boost's.  <a href="classtriplegit_1_1async__io_1_1promise.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpackaged__task.html">packaged_task&lt; class &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">For now, this is an emulation of std::packaged_task based on boost's <a class="el" href="classpackaged__task.html" title="For now, this is an emulation of std::packaged_task based on boost&#39;s packaged_task. We have to drop the Args... support because it segfaults MSVC Nov 2012 CTP.">packaged_task</a>. We have to drop the Args... support because it segfaults MSVC Nov 2012 CTP.  <a href="classpackaged__task.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriplegit_1_1async__io_1_1thread__pool.html">triplegit::async_io::thread_pool</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A very simple thread pool based on Boost.ASIO and std::thread.  <a href="classtriplegit_1_1async__io_1_1thread__pool.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriplegit_1_1async__io_1_1detail_1_1async__io__handle.html">triplegit::async_io::detail::async_io_handle</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">May occasionally be useful to access to discover information about an open handle.  <a href="classtriplegit_1_1async__io_1_1detail_1_1async__io__handle.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriplegit_1_1async__io_1_1async__file__io__dispatcher__base.html">triplegit::async_io::async_file_io_dispatcher_base</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abstract base class for dispatching file i/o asynchronously.  <a href="classtriplegit_1_1async__io_1_1async__file__io__dispatcher__base.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtriplegit_1_1async__io_1_1async__io__op.html">triplegit::async_io::async_io_op</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference to an async operation.  <a href="structtriplegit_1_1async__io_1_1async__io__op.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtriplegit_1_1async__io_1_1async__path__op__req.html">triplegit::async_io::async_path_op_req</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A convenience bundle of path and flags, with optional precondition.  <a href="structtriplegit_1_1async__io_1_1async__path__op__req.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtriplegit_1_1async__io_1_1async__data__op__req.html">triplegit::async_io::async_data_op_req&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A specialisation for any pointer to type T.  <a href="structtriplegit_1_1async__io_1_1async__data__op__req.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtriplegit_1_1async__io_1_1async__data__op__req_3_01std_1_1vector_3_01_t_00_01_a_01_4_01_4.html">triplegit::async_io::async_data_op_req&lt; std::vector&lt; T, A &gt; &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A specialisation for any std::vector&lt;T, A&gt;  <a href="structtriplegit_1_1async__io_1_1async__data__op__req_3_01std_1_1vector_3_01_t_00_01_a_01_4_01_4.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtriplegit_1_1async__io_1_1async__data__op__req_3_01std_1_1array_3_01_t_00_01_n_01_4_01_4.html">triplegit::async_io::async_data_op_req&lt; std::array&lt; T, N &gt; &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A specialisation for any std::array&lt;T, N&gt;  <a href="structtriplegit_1_1async__io_1_1async__data__op__req_3_01std_1_1array_3_01_t_00_01_n_01_4_01_4.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtriplegit_1_1async__io_1_1async__data__op__req_3_01std_1_1basic__string_3_01_c_00_01_t_00_01_a_01_4_01_4.html">triplegit::async_io::async_data_op_req&lt; std::basic_string&lt; C, T, A &gt; &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A specialisation for any std::basic_string&lt;C, T, A&gt;  <a href="structtriplegit_1_1async__io_1_1async__data__op__req_3_01std_1_1basic__string_3_01_c_00_01_t_00_01_a_01_4_01_4.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetriplegit_1_1async__io"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html">triplegit::async_io</a></td></tr>
<tr class="memdesc:namespacetriplegit_1_1async__io"><td class="mdescLeft">&#160;</td><td class="mdescRight">The namespace containing the Boost.ASIO asynchronous file i/o implementation. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af28c26398a12ba760165fc40f2a74ca3"><td class="memItemLeft" align="right" valign="top">typedef boost::exception_ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#af28c26398a12ba760165fc40f2a74ca3">triplegit::async_io::exception_ptr</a></td></tr>
<tr class="memdesc:af28c26398a12ba760165fc40f2a74ca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">For now, this is boost's exception_ptr. Will be replaced when C++'s exception_ptr catches up with boost's.  <a href="#af28c26398a12ba760165fc40f2a74ca3"></a><br/></td></tr>
<tr class="separator:af28c26398a12ba760165fc40f2a74ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6743cd614fc8161dfce94144c36cfb85"><td class="memItemLeft" align="right" valign="top">thread_pool &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#a6743cd614fc8161dfce94144c36cfb85">triplegit::async_io::process_threadpool</a> ()</td></tr>
<tr class="memdesc:a6743cd614fc8161dfce94144c36cfb85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the process threadpool.  <a href="#a6743cd614fc8161dfce94144c36cfb85"></a><br/></td></tr>
<tr class="separator:a6743cd614fc8161dfce94144c36cfb85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc5e0576470c19d979b3b853305fc7d6"><td class="memTemplParams" colspan="2">template&lt;class InputIterator &gt; </td></tr>
<tr class="memitem:afc5e0576470c19d979b3b853305fc7d6"><td class="memTemplItemLeft" align="right" valign="top">future&lt; std::vector&lt; typename <br class="typebreak"/>
std::decay&lt; decltype(((typename <br class="typebreak"/>
InputIterator::value_type *) 0) -&gt;<br class="typebreak"/>
get())&gt;::type &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#afc5e0576470c19d979b3b853305fc7d6">triplegit::async_io::when_all</a> (InputIterator first, InputIterator last)</td></tr>
<tr class="memdesc:afc5e0576470c19d979b3b853305fc7d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a future vector of results from all the supplied futures.  <a href="#afc5e0576470c19d979b3b853305fc7d6"></a><br/></td></tr>
<tr class="separator:afc5e0576470c19d979b3b853305fc7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac024775f7df8eb059d2aeee8de8f5ff9"><td class="memTemplParams" colspan="2">template&lt;class InputIterator &gt; </td></tr>
<tr class="memitem:ac024775f7df8eb059d2aeee8de8f5ff9"><td class="memTemplItemLeft" align="right" valign="top">future&lt; std::pair&lt; size_t, <br class="typebreak"/>
typename std::decay&lt; decltype(((typename <br class="typebreak"/>
InputIterator::value_type *) 0) -&gt;<br class="typebreak"/>
get())&gt;::type &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#ac024775f7df8eb059d2aeee8de8f5ff9">triplegit::async_io::when_any</a> (InputIterator first, InputIterator last)</td></tr>
<tr class="memdesc:ac024775f7df8eb059d2aeee8de8f5ff9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a future tuple of results from all the supplied futures.  <a href="#ac024775f7df8eb059d2aeee8de8f5ff9"></a><br/></td></tr>
<tr class="separator:ac024775f7df8eb059d2aeee8de8f5ff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6da488279e514281ae9d5904d8d426"><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak"/>
&lt; async_file_io_dispatcher_base &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#afa6da488279e514281ae9d5904d8d426">triplegit::async_io::async_file_io_dispatcher</a> (thread_pool &amp;threadpool=process_threadpool(), file_flags flagsforce=file_flags::None, file_flags flagsmask=file_flags::None)</td></tr>
<tr class="memdesc:afa6da488279e514281ae9d5904d8d426"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instatiates the best available async_file_io_dispatcher implementation for this system.  <a href="#afa6da488279e514281ae9d5904d8d426"></a><br/></td></tr>
<tr class="separator:afa6da488279e514281ae9d5904d8d426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae692c0402d30c1350b8475c8d9c42c69"><td class="memItemLeft" align="right" valign="top">future&lt; std::vector<br class="typebreak"/>
&lt; std::shared_ptr<br class="typebreak"/>
&lt; detail::async_io_handle &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#ae692c0402d30c1350b8475c8d9c42c69">triplegit::async_io::when_all</a> (std::nothrow_t, std::vector&lt; async_io_op &gt;::iterator first, std::vector&lt; async_io_op &gt;::iterator last)</td></tr>
<tr class="memdesc:ae692c0402d30c1350b8475c8d9c42c69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience overload for a vector of <a class="el" href="structtriplegit_1_1async__io_1_1async__io__op.html" title="A reference to an async operation.">async_io_op</a>. Does not retrieve exceptions.  <a href="#ae692c0402d30c1350b8475c8d9c42c69"></a><br/></td></tr>
<tr class="separator:ae692c0402d30c1350b8475c8d9c42c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c882426142e8f23d1e37d2835035fa"><td class="memItemLeft" align="right" valign="top">future&lt; std::vector<br class="typebreak"/>
&lt; std::shared_ptr<br class="typebreak"/>
&lt; detail::async_io_handle &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#ab4c882426142e8f23d1e37d2835035fa">triplegit::async_io::when_all</a> (std::vector&lt; async_io_op &gt;::iterator first, std::vector&lt; async_io_op &gt;::iterator last)</td></tr>
<tr class="memdesc:ab4c882426142e8f23d1e37d2835035fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience overload for a vector of <a class="el" href="structtriplegit_1_1async__io_1_1async__io__op.html" title="A reference to an async operation.">async_io_op</a>. Retrieves exceptions.  <a href="#ab4c882426142e8f23d1e37d2835035fa"></a><br/></td></tr>
<tr class="separator:ab4c882426142e8f23d1e37d2835035fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb978d2fbe374855ddd0e539f38e5316"><td class="memItemLeft" align="right" valign="top">future&lt; std::vector<br class="typebreak"/>
&lt; std::shared_ptr<br class="typebreak"/>
&lt; detail::async_io_handle &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#abb978d2fbe374855ddd0e539f38e5316">triplegit::async_io::when_all</a> (std::nothrow_t _, std::initializer_list&lt; async_io_op &gt; _ops)</td></tr>
<tr class="memdesc:abb978d2fbe374855ddd0e539f38e5316"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience overload for a list of <a class="el" href="structtriplegit_1_1async__io_1_1async__io__op.html" title="A reference to an async operation.">async_io_op</a>. Does not retrieve exceptions.  <a href="#abb978d2fbe374855ddd0e539f38e5316"></a><br/></td></tr>
<tr class="separator:abb978d2fbe374855ddd0e539f38e5316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0503557b870c07ccf9e43f4e3096c446"><td class="memItemLeft" align="right" valign="top">future&lt; std::vector<br class="typebreak"/>
&lt; std::shared_ptr<br class="typebreak"/>
&lt; detail::async_io_handle &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetriplegit_1_1async__io.html#a0503557b870c07ccf9e43f4e3096c446">triplegit::async_io::when_all</a> (std::initializer_list&lt; async_io_op &gt; _ops)</td></tr>
<tr class="memdesc:a0503557b870c07ccf9e43f4e3096c446"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience overload for a list of <a class="el" href="structtriplegit_1_1async__io_1_1async__io__op.html" title="A reference to an async operation.">async_io_op</a>. Retrieves exceptions.  <a href="#a0503557b870c07ccf9e43f4e3096c446"></a><br/></td></tr>
<tr class="separator:a0503557b870c07ccf9e43f4e3096c446"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides a batch asynchronous file i/o implementation based on Boost.ASIO. </p>
<p>My Seagate 7200rpm drive: <hr/>
 CrystalDiskMark 3.0.2 x64 (C) 2007-2013 hiyohiyo </p>
<h2>Crystal Dew World : <a href="http://crystalmark.info/">http://crystalmark.info/</a></h2>
<p>MB/s = 1,000,000 byte/s [SATA/300 = 300,000,000 byte/s] </p>
<pre class="fragment">     Sequential Read :    46.012 MB/s
    Sequential Write :    44.849 MB/s
   Random Read 512KB :    26.367 MB/s
  Random Write 512KB :    23.521 MB/s
</pre><p> Random Read 4KB (QD=1) : 0.487 MB/s [ 118.8 IOPS] Random Write 4KB (QD=1) : 0.771 MB/s [ 188.3 IOPS] Random Read 4KB (QD=32) : 0.819 MB/s [ 199.8 IOPS] Random Write 4KB (QD=32) : 0.789 MB/s [ 192.6 IOPS]</p>
<p>Test : 1000 MB [G: 99.0% (178.2/180.1 GB)] (x5) Date : 2013/04/13 23:02:23 OS : Windows 8 [6.2 Build 9200] (x64)</p>
<p>Windows IOCP backend, 3.5Ghz Ivy Bridge Windows 8 x64 on my Seagate 7200rpm drive:</p>
<p>1000 file opens, writes 1 byte, closes, and deletes: It took 0.26311 secs to do all operations It took 0.0079942 secs to dispatch all operations It took 0.255116 secs to finish all operations</p>
<p>It took 0.0899875 secs to do 11112.7 file opens per sec It took 0.0100023 secs to do 99977 file writes per sec It took 0.0210025 secs to do 47613.4 file closes per sec It took 0.142118 secs to do 7036.43 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes: It took 1.01195 secs to do all operations It took 0.0079939 secs to dispatch all operations It took 1.00396 secs to finish all operations</p>
<p>It took 0.10599 secs to do 9434.83 file opens per sec It took 0.0410053 secs to do 24387.1 file writes per sec It took 0.769099 secs to do 1300.22 file closes per sec It took 0.0958558 secs to do 10432.3 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with synchronous i/o: It took 9.28653 secs to do all operations It took 0.142254 secs to dispatch all operations It took 9.14427 secs to finish all operations</p>
<p>It took 8.92534 secs to do 112.041 file opens per sec It took 0.112127 secs to do 8918.5 file writes per sec It took 0.177022 secs to do 5649.03 file closes per sec It took 0.0720397 secs to do 13881.2 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with synchronous i/o: It took 3.03522 secs to do all operations It took 0.0212259 secs to dispatch all operations It took 3.01399 secs to finish all operations</p>
<p>It took 1.92052 secs to do 520.694 file opens per sec It took 0.0720104 secs to do 13886.9 file writes per sec It took 0.806102 secs to do 1240.54 file closes per sec It took 0.236588 secs to do 4226.75 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with autoflush i/o: It took 11.9628 secs to do all operations It took 0.0080006 secs to dispatch all operations It took 11.9548 secs to finish all operations</p>
<p>It took 0.0940122 secs to do 10636.9 file opens per sec It took 0.46754 secs to do 2138.85 file writes per sec It took 11.2472 secs to do 88.9107 file closes per sec It took 0.154042 secs to do 6491.76 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with autoflush i/o: It took 14.5824 secs to do all operations It took 0.0080019 secs to dispatch all operations It took 14.5744 secs to finish all operations</p>
<p>It took 0.0980132 secs to do 10202.7 file opens per sec It took 0.465669 secs to do 2147.45 file writes per sec It took 13.8906 secs to do 71.9913 file closes per sec It took 0.128166 secs to do 7802.36 file deletions per sec</p>
<p>POSIX compat backend, 3.5Ghz Ivy Bridge Linux 3.2 x64 on my Seagate 7200rpm drive:</p>
<p>1000 file opens, writes 1 byte, closes, and deletes: It took 0.03907 secs to do all operations It took 0.00425 secs to dispatch all operations It took 0.03482 secs to finish all operations</p>
<p>It took 0.015097 secs to do 66238.3 file opens per sec It took 0.009744 secs to do 102627 file writes per sec It took 0.008307 secs to do 120380 file closes per sec It took 0.005922 secs to do 168862 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes: It took 0.039257 secs to do all operations It took 0.004198 secs to dispatch all operations It took 0.035059 secs to finish all operations</p>
<p>It took 0.017462 secs to do 57267.2 file opens per sec It took 0.010241 secs to do 97646.7 file writes per sec It took 0.007234 secs to do 138236 file closes per sec It took 0.00432 secs to do 231481 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with synchronous i/o: It took 7.53982 secs to do all operations It took 0.003997 secs to dispatch all operations It took 7.53582 secs to finish all operations</p>
<p>It took 6.35027 secs to do 157.473 file opens per sec It took 1.18224 secs to do 845.848 file writes per sec It took 0.005773 secs to do 173220 file closes per sec It took 0.001528 secs to do 654450 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with synchronous i/o: It took 7.97113 secs to do all operations It took 0.004116 secs to dispatch all operations It took 7.96701 secs to finish all operations</p>
<p>It took 6.32829 secs to do 158.021 file opens per sec It took 1.63634 secs to do 611.12 file writes per sec It took 0.004897 secs to do 204207 file closes per sec It took 0.001605 secs to do 623053 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with autoflush i/o: It took 7.46535 secs to do all operations It took 0.00405 secs to dispatch all operations It took 7.4613 secs to finish all operations</p>
<p>It took 6.30895 secs to do 158.505 file opens per sec It took 1.12623 secs to do 887.922 file writes per sec It took 0.02834 secs to do 35285.8 file closes per sec It took 0.001838 secs to do 544070 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with autoflush i/o: It took 8.0235 secs to do all operations It took 0.00419 secs to dispatch all operations It took 8.01931 secs to finish all operations</p>
<p>It took 6.29931 secs to do 158.748 file opens per sec It took 1.68728 secs to do 592.67 file writes per sec It took 0.035096 secs to do 28493.3 file closes per sec It took 0.001815 secs to do 550964 file deletions per sec</p>
<h2>My Samsung 256Gb 830 SSD:</h2>
<p>CrystalDiskMark 3.0.2 x64 (C) 2007-2013 hiyohiyo </p>
<h2>Crystal Dew World : <a href="http://crystalmark.info/">http://crystalmark.info/</a></h2>
<p>MB/s = 1,000,000 byte/s [SATA/300 = 300,000,000 byte/s] </p>
<pre class="fragment">     Sequential Read :   478.802 MB/s
    Sequential Write :   406.425 MB/s
   Random Read 512KB :   337.185 MB/s
  Random Write 512KB :   390.353 MB/s
</pre><p> Random Read 4KB (QD=1) : 21.235 MB/s [ 5184.4 IOPS] Random Write 4KB (QD=1) : 58.373 MB/s [ 14251.1 IOPS] Random Read 4KB (QD=32) : 301.170 MB/s [ 73527.7 IOPS] Random Write 4KB (QD=32) : 148.339 MB/s [ 36215.5 IOPS]</p>
<p>Test : 1000 MB [C: 72.2% (57.3/79.4 GB)] (x5) Date : 2013/04/13 23:10:09 OS : Windows 8 [6.2 Build 9200] (x64)</p>
<p>Windows IOCP backend, 3.5Ghz Ivy Bridge Windows 8 x64 on my Samsung 256Gb 830 SSD drive:</p>
<p>1000 file opens, writes 1 byte, closes, and deletes: It took 0.187081 secs to do all operations It took 0.0079831 secs to dispatch all operations It took 0.179098 secs to finish all operations</p>
<p>It took 0.0789921 secs to do 12659.5 file opens per sec It took 0.0110014 secs to do 90897.5 file writes per sec It took 0.0250035 secs to do 39994.4 file closes per sec It took 0.0720843 secs to do 13872.6 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes: It took 0.924099 secs to do all operations It took 0.007996 secs to dispatch all operations It took 0.916103 secs to finish all operations</p>
<p>It took 0.0859878 secs to do 11629.6 file opens per sec It took 0.0230033 secs to do 43472 file writes per sec It took 0.7571 secs to do 1320.83 file closes per sec It took 0.0580077 secs to do 17239.1 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with synchronous i/o: It took 2.98316 secs to do all operations It took 0.0446 secs to dispatch all operations It took 2.93856 secs to finish all operations</p>
<p>It took 2.71914 secs to do 367.763 file opens per sec It took 0.0359893 secs to do 27786 file writes per sec It took 0.151021 secs to do 6621.6 file closes per sec It took 0.0770071 secs to do 12985.8 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with synchronous i/o: It took 1.65352 secs to do all operations It took 0.0149789 secs to dispatch all operations It took 1.63854 secs to finish all operations</p>
<p>It took 0.714499 secs to do 1399.58 file opens per sec It took 0.0420066 secs to do 23805.8 file writes per sec It took 0.835109 secs to do 1197.45 file closes per sec It took 0.0619072 secs to do 16153.2 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with autoflush i/o: It took 2.70265 secs to do all operations It took 0.0089945 secs to dispatch all operations It took 2.69366 secs to finish all operations</p>
<p>It took 0.0759873 secs to do 13160.1 file opens per sec It took 0.0334323 secs to do 29911.2 file writes per sec It took 2.46722 secs to do 405.315 file closes per sec It took 0.126015 secs to do 7935.54 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with autoflush i/o: It took 2.79222 secs to do all operations It took 0.0079943 secs to dispatch all operations It took 2.78422 secs to finish all operations</p>
<p>It took 0.0829872 secs to do 12050.1 file opens per sec It took 0.0381194 secs to do 26233.4 file writes per sec It took 2.6111 secs to do 382.98 file closes per sec It took 0.0600064 secs to do 16664.9 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with direct i/o: It took 0.178027 secs to do all operations It took 0.0070116 secs to dispatch all operations It took 0.171015 secs to finish all operations</p>
<p>It took 0.0629898 secs to do 15875.6 file opens per sec It took 0.0110008 secs to do 90902.5 file writes per sec It took 0.0190018 secs to do 52626.6 file closes per sec It took 0.0850346 secs to do 11759.9 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with direct i/o: It took 1.67592 secs to do all operations It took 0.0169852 secs to dispatch all operations It took 1.65893 secs to finish all operations</p>
<p>It took 0.711476 secs to do 1405.53 file opens per sec It took 0.0163148 secs to do 61294 file writes per sec It took 0.890117 secs to do 1123.45 file closes per sec It took 0.058008 secs to do 17239 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with direct synchronous i/o:</p>
<p>It took 0.309121 secs to do all operations It took 0.00698 secs to dispatch all operations It took 0.302141 secs to finish all operations</p>
<p>It took 0.138198 secs to do 7235.99 file opens per sec It took 0.0142443 secs to do 70203.5 file writes per sec It took 0.0796398 secs to do 12556.5 file closes per sec It took 0.0770388 secs to do 12980.5 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with direct synchronous i/o: It took 1.95023 secs to do all operations It took 0.020987 secs to dispatch all operations It took 1.92924 secs to finish all operations</p>
<p>It took 0.967097 secs to do 1034.02 file opens per sec It took 0.0290068 secs to do 34474.7 file writes per sec It took 0.901115 secs to do 1109.74 file closes per sec It took 0.0530077 secs to do 18865.2 file deletions per sec</p>
<p>iozone -e -I -a -s 1000M -r 4k -r 512k -i 0 -i 1 -i 2 random random bkwd record stride KB reclen write rewrite read reread read write read rewrite read fwrite frewrite fread freread 1024000 4 2528 3044 12000 11693 11337 931 1024000 512 17393 17039 68703 68524 67958 3881</p>
<p>iozone -e -I -s 31M -r 4k -t 32 -T -i 0 -i 2 </p>
<pre class="fragment">    Children see throughput for 2 initial writers = 1502.15 KB/sec
    Parent sees throughput for 2 initial writers = 1502.13 KB/sec
    Min throughput per thread = 751.07 KB/sec
    Max throughput per thread = 751.08 KB/sec
    Avg throughput per thread = 751.07 KB/sec
    Min xfer = 511992.00 KB

    Children see throughput for 2 rewriters = 1537.12 KB/sec
    Parent sees throughput for 2 rewriters = 1537.11 KB/sec
    Min throughput per thread = 768.34 KB/sec
    Max throughput per thread = 768.77 KB/sec
    Avg throughput per thread = 768.56 KB/sec
    Min xfer = 511716.00 KB

    Children see throughput for 2 random readers = 9044.48 KB/sec
    Parent sees throughput for 2 random readers = 9044.42 KB/sec
    Min throughput per thread = 4521.79 KB/sec
    Max throughput per thread = 4522.69 KB/sec
    Avg throughput per thread = 4522.24 KB/sec
    Min xfer = 511900.00 KB

    Children see throughput for 2 random writers = 825.19 KB/sec
    Parent sees throughput for 2 random writers = 825.14 KB/sec
    Min throughput per thread = 412.52 KB/sec
    Max throughput per thread = 412.67 KB/sec
    Avg throughput per thread = 412.60 KB/sec
    Min xfer = 511812.00 KB
</pre><p>From these I infer: </p>
<pre class="fragment">       Sequential Read :   67.09 MB/s
      Sequential Write :   16.98 MB/s
     Random Read 512KB :   66.36 MB/s
    Random Write 512KB :    3.79 MB/s
Random Read 4KB (QD=1) :   11.42 MB/s [ 2834.3 IOPS]
</pre><p> Random Write 4KB (QD=1) : 0.91 MB/s [ 232.8 IOPS] Random Read 4KB (QD=32) : ? MB/s [ ? IOPS] Random Write 4KB (QD=32) : ? MB/s [ ? IOPS]</p>
<p>POSIX compat backend, 1.7Ghz ARM Cortex-A15 Linux 3.4 on Samsung Chromebook eMMC internal drive:</p>
<p>1000 file opens, writes 1 byte, closes, and deletes: It took 0.386876 secs to do all operations It took 0.110156 secs to dispatch all operations It took 0.27672 secs to finish all operations</p>
<p>It took 0.181143 secs to do 5520.5 file opens per sec It took 0.094321 secs to do 10602.1 file writes per sec It took 0.070552 secs to do 14173.9 file closes per sec It took 0.04086 secs to do 24473.8 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes: It took 0.425939 secs to do all operations It took 0.147966 secs to dispatch all operations It took 0.277973 secs to finish all operations</p>
<p>It took 0.17901 secs to do 5586.28 file opens per sec It took 0.152722 secs to do 6547.85 file writes per sec It took 0.054538 secs to do 18335.8 file closes per sec It took 0.039669 secs to do 25208.6 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with synchronous i/o: It took 19.4941 secs to do all operations It took 0.07904 secs to dispatch all operations It took 19.4151 secs to finish all operations</p>
<p>It took 13.323 secs to do 75.058 file opens per sec It took 6.06393 secs to do 164.909 file writes per sec It took 0.071753 secs to do 13936.7 file closes per sec It took 0.035389 secs to do 28257.4 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with synchronous i/o: It took 22.8757 secs to do all operations It took 0.102336 secs to dispatch all operations It took 22.7734 secs to finish all operations</p>
<p>It took 5.35023 secs to do 186.908 file opens per sec It took 17.498 secs to do 57.1495 file writes per sec It took 0.014796 secs to do 67585.8 file closes per sec It took 0.012747 secs to do 78449.8 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with autoflush i/o: It took 13.2068 secs to do all operations It took 0.085519 secs to dispatch all operations It took 13.1213 secs to finish all operations</p>
<p>It took 9.65411 secs to do 103.583 file opens per sec It took 3.40673 secs to do 293.537 file writes per sec It took 0.119205 secs to do 8388.91 file closes per sec It took 0.02677 secs to do 37355.2 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with autoflush i/o: It took 24.0624 secs to do all operations It took 0.092833 secs to dispatch all operations It took 23.9695 secs to finish all operations</p>
<p>It took 12.9862 secs to do 77.0047 file opens per sec It took 10.8002 secs to do 92.5906 file writes per sec It took 0.219705 secs to do 4551.56 file closes per sec It took 0.05619 secs to do 17796.8 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with direct i/o: [Started testing]</p>
<p>[Running: async_io/works/1/direct] unittests/main.cpp:266: !(((size_t) &amp;towrite.front()) &amp; 4095) failed with unexpected exception with message: 'Invalid argument (22) in 'triplegit/src/async_file_io.cpp':dowrite:884' [Finished: 'async_io/works/1/direct' 1 test case failed (1 of 2 assertions failed)]</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with direct i/o: It took 6.84248 secs to do all operations It took 0.125639 secs to dispatch all operations It took 6.71684 secs to finish all operations</p>
<p>It took 0.204354 secs to do 4893.47 file opens per sec It took 6.58176 secs to do 151.935 file writes per sec It took 0.025033 secs to do 39947.3 file closes per sec It took 0.031331 secs to do 31917.3 file deletions per sec</p>
<p>1000 file opens, writes 1 byte, closes, and deletes with direct synchronous i/o: It took 7.00683 secs to do all operations It took 0.054578 secs to dispatch all operations It took 6.95225 secs to finish all operations</p>
<p>It took 6.88883 secs to do 145.163 file opens per sec It took 0.057979 secs to do 17247.6 file writes per sec It took 0.030898 secs to do 32364.6 file closes per sec It took 0.029125 secs to do 34334.8 file deletions per sec</p>
<p>1000 file opens, writes 64Kb, closes, and deletes with direct synchronous i/o: It took 24.9112 secs to do all operations It took 0.058847 secs to dispatch all operations It took 24.8524 secs to finish all operations</p>
<p>It took 11.8282 secs to do 84.5438 file opens per sec It took 13.0079 secs to do 76.8762 file writes per sec It took 0.057255 secs to do 17465.7 file closes per sec It took 0.017878 secs to do 55934.7 file deletions per sec </p>
</div></div><!-- contents -->
<hr class="footer"/><address class="footer">(C) 2012 <a href="http://www.nedprod.com/">Niall Douglas</a></address>
</body>
</html>
